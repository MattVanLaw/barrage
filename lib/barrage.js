!function(t){var e={};function i(s){if(e[s])return e[s].exports;var h=e[s]={i:s,l:!1,exports:{}};return t[s].call(h.exports,h,h.exports,i),h.l=!0,h.exports}i.m=t,i.c=e,i.d=function(t,e,s){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:s})},i.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var s=Object.create(null);if(i.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var h in t)i.d(s,h,function(e){return t[e]}.bind(null,h));return s},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="",i(i.s=0)}([function(t,e,i){"use strict";i.r(e);var s=class{constructor(t){this.context=t.context,this.width=t.width,this.height=t.height,this.image=t.image,this.x=t.x,this.y=t.y,this.cropX=t.cropX,this.cropY=t.cropY,this.frameWidth=t.frameWidth,this.frameHeight=t.frameHeight,this.update=this.update.bind(this),this.frameIndex=0,this.tickCount=0,this.ticksPerFrame=t.ticksPerFrame||0,this.numberOfFrames=t.numberOfFrames||1,this.loop=t.loop}render(){this.context.drawImage(this.image,this.cropX,this.cropY,this.frameWidth,this.frameHeight,this.x,this.y,this.width,this.height)}update(){this.tickCount+=1,this.tickCount>this.ticksPerFrame&&(this.tickCount=0,this.frameIndex<this.numberOfFrames-1?this.frameIndex+=1:this.loop&&(this.frameIndex=0))}};var h=class{constructor(t,e,i){this.canvas=i,this.ctx=e,this.x=t[0],this.y=t[1],this.width=4,this.height=17,this.bulletImage=new Image,this.bulletImage.src="assets/bullet.png",this.render=this.render.bind(this)}render(){new s({context:this.canvas.getContext("2d"),cropX:0,cropY:0,x:this.x-1,y:this.y-1,width:7,height:20,image:this.bulletImage,frameWidth:600,frameHeight:700}).render()}update(t){this.x+=t[0],this.y-=t[1]}draw(){this.ctx.beginPath(),this.ctx.rect(this.x,this.y,this.width,this.height),this.ctx.closePath()}};const r=document.getElementById("myCanvas");var n={1:{image:"assets/ship.png",default:{width:30,height:20,x:(r.width-28)/2,y:r.height-28,hp:10,weapon:[0,6],bulletCount:1},quick:{width:30,height:20,weapon:[0,10],bulletCount:1},machineGun:{width:30,height:20,weapon:[0,6],bulletCount:15}},2:{default:{width:30,height:20,x:(r.width-28)/2,y:r.height-28,hp:10,weapon:[0,6],bulletCount:1},quick:{width:30,height:20,weapon:[0,10],bulletCount:1},machineGun:{width:30,height:20,weapon:[0,6],bulletCount:15}}};var o=class{constructor(t,e,i,s){this.canvas=t,this.ctx=e,this.type=i,this.props=n[i][s],this.shipTree=n[i],this.fire=this.fire.bind(this),this.reload=this.reload.bind(this),this._buildBullets=this._buildBullets.bind(this),this.bullets=this._buildBullets(),this.createSprite=this.createSprite.bind(this),this.createLeftSprite=this.createLeftSprite.bind(this),this.createRightSprite=this.createRightSprite.bind(this),this.changeBulletCount=this.changeBulletCount.bind(this)}changeBulletCount(t){this.props.bulletCount=t,this.bullets=this._buildBullets()}_buildBullets(){const t=[];for(let e=0;e<this.props.bulletCount;e++)t.push(new h([this.props.x,this.props.y],this.ctx,this.canvas));return t}createSprite(){let t=new Image;return t.src=this.shipTree.image,new s({context:this.canvas.getContext("2d"),cropX:0,cropY:258,x:(this.canvas.width-28)/2-17,y:this.canvas.height-28-12.5,width:this.props.width+20,height:this.props.height+20,image:t,frameWidth:60,frameHeight:42})}createLeftSprite(){let t=new Image;return t.src=this.shipTree.image,new s({context:this.canvas.getContext("2d"),cropX:0,cropY:321,x:this.canvas.width-28-12,y:this.canvas.height-28-12.5,width:this.props.width+20,height:this.props.height+20,image:t,frameWidth:60,frameHeight:43})}createRightSprite(){let t=new Image;return t.src=this.shipTree.image,new s({context:this.canvas.getContext("2d"),cropX:0,cropY:385,x:this.canvas.width/2,y:this.canvas.height-28-12.5,width:this.props.width+20,height:this.props.height+20,image:t,frameWidth:60,frameHeight:42})}fire(){this.bullets.forEach(t=>{t.render(),t.draw(),t.update(this.props.weapon)})}reload(){this.bullets.forEach((t,e)=>{t.y<2&&(t.x=this.props.x+this.props.width/2-2,t.y=this.props.y-(this.props.bulletCount-e+2))})}draw(){this.createSprite(),this.createLeftSprite(),this.createRightSprite(),this.ctx.beginPath(),this.ctx.rect(this.props.x,this.props.y,this.props.width,this.props.height),this.ctx.closePath()}};var a=(t,e)=>t.x<e.x+e.width&&t.x+t.width>e.x&&t.y<e.y+e.height&&t.y+t.height>e.y;class p{constructor(t,e,i,s){this.x=t[0],this.y=t[1],this.width=e,this.height=i,this.ctx=s,this.renderExplosion=this.renderExplosion.bind(this),this.animateExplosion=this.animateExplosion.bind(this),this.update=this.update.bind(this),this.randomX=2e3*Math.random()+1,this.randomY=2e3*Math.random()+1}static buildAllEnemies(t,e){const i=[],s=[],h=[],r=[];for(let n=0;n<1e3;n++){let n=Math.floor(Math.random()*(t.width-60)+15);i.push(new p([n,-45],15,35,e)),n=Math.floor(Math.random()*(t.width-60)+15),s.push(new p([n,-45],15,35,e));let o=Math.floor(Math.random()*t.height)-t.height/2;h.push(new p([-60,o],50,18,e)),n=Math.floor(Math.random()*(t.width-60)+15),r.push(new p([n,12],15,35,e))}return{enemies1:i,enemies1b:s,enemies2:h,bossBullets:r}}static sprite(t,e){let i=new Image;return i.src="assets/enemy-missiles.png",new s({context:t.getContext("2d"),cropX:0,cropY:117,x:e.x-(e.width/2-5),y:e.y,width:15.4,height:42,image:i,frameWidth:31,frameHeight:126})}playerHit(t,e,i){return a(t,this)?(this.die(e),t.hp--,$w(".health").html(t.hp),i-100):i}killed(t,e,i,s,h){if(a(h,this)){return this.die(t),h.x=s.x+s.width/2-2,h.y=s.y-(2+s.bulletCount),{score:e+1e3+(i.height-s.y),dead:this}}return{score:e}}renderExplosion(t){let e=new Image;return e.src=t,new s({context:this.ctx,cropY:0,x:this.x,y:this.y,width:52,height:300,image:e,frameWidth:42,frameHeight:300})}animateExplosion(t,e){e.cropX=50.8888*t,e.x=this.x,e.y=this.y,e.render()}died(t,e,i){return t.length>0&&this.y>=i.height||t.length>0&&this.x>=i.width?(t.shift(),e-1e3):e}die(t){t.shift()}update(t){this.x+=t[0],this.y+=t[1]}draw(){this.ctx.beginPath(),this.ctx.rect(this.x,this.y,this.width,this.height),this.ctx.fillStyle="#0f380f",this.ctx.fill(),this.ctx.closePath()}}var d=p;const l=["quick","machineGun","health"];class c{constructor(t,e,i,s,h){this.type=null,this.ctx=s,this.canvas=h,this.x=t[0],this.y=t[1],this.width=e[0],this.height=e[1],this.ships=i,this.collided=!1,this.powerUp=this.powerUp.bind(this),this.resetShip=this.resetShip.bind(this),this.collide=this.collide.bind(this),this.used=this.used.bind(this)}static buildAllPowerUps(t,e,i){const s=[];for(let h=0;h<1e3;h++){let h=Math.floor(Math.random()*t.width)+1,r=l[Math.floor(Math.random()*l.length)],n=new c([h,0],[15,14],i,e,t);n.type=r,s.push(n)}return s}static sprite(t,e){let i=new Image;return i.src="assets/m-powerup.png",new s({context:t.getContext("2d"),cropX:0,cropY:0,x:e[0].x,y:e[0].y,width:20,height:20,image:i,frameWidth:50,frameHeight:50})}draw(){this.ctx.beginPath(),this.ctx.rect(this.x,this.y,this.width,this.height),this.ctx.closePath()}update(t,e){this.y+=1.5,this.y===t.height&&(this.y=0,e.shift())}powerUp(){const t=new o(this.canvas,this.ctx,1,this.type);t.props.x=this.ships[0].props.x,t.props.y=this.ships[0].props.y,t.props.hp=this.ships[0].props.hp,this.ships.push(t),this.ships.shift()}resetShip(){const t=new o(this.canvas,this.ctx,1,"default");t.props.x=this.ships[0].props.x,t.props.y=this.ships[0].props.y,t.props.hp=this.ships[0].props.hp,this.ships.push(t),this.ships.shift()}collide(t){this.ships[0].props.x<this.x+this.width&&this.ships[0].props.x+this.ships[0].props.width>this.x&&this.ships[0].props.y<this.y+this.height&&this.ships[0].props.y+this.ships[0].props.height>this.y&&("health"===this.type?(this.collided||(this.ships[0].props.hp+=5),this.collided=!0,t.shift()):(this.powerUp(),this.used(t)))}used(t){t.shift(),this.powerUp(),setTimeout(()=>this.resetShip(),5e3)}}var u=c;var m=class{constructor(t){this.sound=document.createElement("audio"),this.sound.src=t,this.sound.setAttribute("preload","auto"),this.sound.setAttribute("controls","none"),this.sound.style.display="none",document.body.appendChild(this.sound),this.play=(()=>this.sound.play()),this.stop=(()=>this.sound.pause())}};const g=(t,e)=>{$w(".start-menu").html("Pause"),$w(".start-menu").addClass("hidden")};let y=$w(".score").html();const x=(t,e,i)=>{if(t<=0){const t=document.getElementById("name");$w(".start-menu").html('Game Over<br/><span class="replay">Press enter to play</span>');let s="noname";return t.addEventListener("change",t=>{s=t.target.value}),document.getElementsByTagName("form")[0].addEventListener("submit",t=>{t.preventDefault(),((t,e)=>{t=t||"noname",document.getElementById("name");parseInt(y),firebase.database().ref().child("scores/").push({name:t,score:e})})(s,i),document.getElementsByTagName("form")[0].classList.add("hidden")}),$w(".start-menu").removeClass("hidden"),document.getElementsByTagName("form")[0].classList.remove("hidden"),$w(".start-menu").off("click",g),document.addEventListener("keydown",t=>{13===t.keyCode&&document.location.reload()}),cancelAnimationFrame(e),!0}};var w=(t,e,i,s)=>{t>1e3&&t<=1120&&(i[0].draw(),((t,e)=>{u.sprite(t,e).render()})(e,i),i[0].update(e,i),i[0].collide(i,"machineGun",s),1120===t&&(t=0,i.shift()))};let f=!1,b=!1,v=!1,C=!1,k=!0;const E=(t,e,i)=>{f&&t.x<e.width-t.width?t.x+=i:b&&t.x>0&&(t.x-=i),v&&t.y>0?t.y-=i:C&&t.y<e.height-t.height&&(t.y+=i)};let S=new m("8-punk-music.mp3");const P=document.getElementById("myCanvas"),I=P.getContext("2d");let M=0;const H=[new o(P,I,1,"default")];let Y=H[0].props,B=0;const X=u.buildAllPowerUps(P,I,H),$=d.buildAllEnemies(P,I),L=$.enemies1,W=$.enemies1b,O=$.enemies2;let _=new Image;_.src="assets/enemy-missiles.png";const A=d.sprite(P,L[0]),F=new s({context:P.getContext("2d"),cropY:39.9,x:W[0].x-(L[0].width/2-5),y:W[0].y,width:15.4,height:42,image:_,frameWidth:31.5,frameHeight:70}),T=()=>{F.x=W[0].x-(W[0].width/2-5),F.y=W[0].y,F.cropX=0,F.render()};let j=new Image;j.src="assets/side-bullet.png";const U=new s({context:P.getContext("2d"),cropX:0,cropY:0,x:O[0].x-1,y:O[0].y-2,width:55,height:20,image:j,frameWidth:67,frameHeight:29}),q=()=>{U.x=O[0].x-1,U.y=O[0].y-2,U.render()};let D=0,R=0,G=0;const N=()=>{if(Y=H[0].props,!x(Y.hp,z,D))if(k)requestAnimationFrame(N);else{I.clearRect(0,0,P.width,P.height),S.play(),$w(".health").html(`HP:${Y.hp}`),$w(".health").attr("style","color: #0f380f"),D+=1,$w(".score").html(D+""),M++,B>=11&&(B=0),(G+=1)%3==0&&++B,b?((t,e,i)=>{const s=t[0].createLeftSprite(e);s.x=t[0].props.x-18,s.y=t[0].props.y-t[0].props.height/2,s.cropX=64*i,s.render()})(H,P,B):f?((t,e,i)=>{const s=t[0].createRightSprite(e);s.x=t[0].props.x-6,s.y=t[0].props.y-t[0].props.height/2,s.cropX=64*i,s.render()})(H,P,B):((t,e,i)=>{const s=t[0].createSprite(e);s.x=t[0].props.x-12,s.y=t[0].props.y-t[0].props.height/2,s.cropX=64*i,s.render()})(H,P,B),A.x=L[0].x-(L[0].width/2-5),A.y=L[0].y,M>=12&&246===A.cropY?(M=0,A.cropY=117):M>=12&&117===A.cropY&&(M=0,A.cropY=246),A.render(),w(R,P,X,H[0]),R+=1;let t=W[0],e=L[0],i=O[0];D<4e4?(e.update([0,2]),t.update([0,3]),T(),q(),i.update([1.9,.5]),H[0].bullets.forEach(e=>{D=i.killed(O,D,P,Y,e,H[0].bullets).score,D=t.killed(W,D,P,Y,e,H[0].bullets).score}),E(Y,P,4)):D>=4e4&&(e.update([0,2.5]),t.update([0,3.5]),T(),q(),i.update([3,1]),H[0].bullets.forEach(e=>{D=i.killed(O,D,P,Y,e,H[0].bullets).score,D=t.killed(W,D,P,Y,e,H[0].bullets).score}),E(Y,P,6)),H[0].bullets.forEach(t=>{D=e.killed(L,D,P,Y,t,H[0].bullets).score}),D=e.playerHit(Y,L,D),D=t.playerHit(Y,W,D),D=i.playerHit(Y,O,D),D=e.died(L,D,P),D=t.died(W,D,P),D=i.died(O,D,P),H[0].draw(),H[0].fire(),H[0].reload(),D>4e4&&$w("#myCanvas").attr("style","background: url('./assets/sky-pink.png"),requestAnimationFrame(N)}};document.addEventListener("keydown",t=>{39===t.keyCode?(t.preventDefault(),f=!0):37===t.keyCode?(t.preventDefault(),b=!0):38===t.keyCode?(t.preventDefault(),v=!0):40===t.keyCode?(t.preventDefault(),C=!0):13===t.keyCode?(t.preventDefault(),k=!k,$w(".start-menu").toggleClass("hidden"),$w(".start-menu").html("Pause")):83===t.keyCode&&(musicPaused=!musicPaused)},!1),document.addEventListener("keyup",t=>{39===t.keyCode?f=!1:37===t.keyCode?b=!1:38===t.keyCode?v=!1:40===t.keyCode&&(C=!1)},!1);const z=requestAnimationFrame(N)}]);